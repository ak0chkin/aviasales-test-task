{"version":3,"sources":["components/Ticket/index.js","components/Filter/index.js","components/Sorting/index.js","components/App/index.js","reportWebVitals.js","index.js"],"names":["Ticket","props","filter","item","checked","map","steps","tickets","includes","segments","every","stops","length","sort","a","b","sorting","price","reduce","acc","curr","duration","slice","idx","carrier","className","toFixed","replace","src","alt","date","destination","origin","moment","format","add","Math","floor","join","viewBox","cx","cy","r","fill","Filter","id","type","value","onChange","htmlFor","text","Sorting","onClick","handleSorting","searchId","abortController","AbortController","App","state","checkedCount","handleFilter","bind","fetch","method","headers","Accept","signal","response","status","console","log","statusText","json","data","this","fetchTickets","Promise","resolve","setTimeout","stop","abort","e","setState","target","fetchSearchId","then","React","Component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.b303b4de.chunk.js","sourcesContent":["import React from 'react';\r\nimport moment from 'moment'\r\nimport './index.css';\r\n\r\nfunction Ticket(props) {\r\n    const filter = props.filter\r\n        .filter(item => item.checked)\r\n        .map(item => item.steps);\r\n    const filteredTickets = filter.includes('all') ? props.tickets : props.tickets.filter(({segments}) => segments.every(({stops}) => filter.includes(stops.length)));\r\n    const sortedTickets = filteredTickets.sort((a, b) => props.sorting === 'price' ? a.price - b.price : (a.segments.reduce((acc, curr) => acc.duration + curr.duration) - b.segments.reduce((acc, curr) => acc.duration + curr.duration)));\r\n    const firstFive = sortedTickets.slice(0, 5);\r\n    const tickets = firstFive.map(({carrier, price, segments}, idx) => (\r\n        <div className=\"ticket\" key={idx}>\r\n            <div className=\"ticket__header segment\">\r\n                <div\r\n                    className=\"segment__item segment__item_left ticket__price\">{price.toFixed().replace(/(\\d)(?=(\\d{3})+([^\\d]|$))/g, '$1 ')} Р\r\n                </div>\r\n                <div className=\"segment__item segment__item_center\"/>\r\n                <div className=\"segment__item segment__item_right\"><img src={`//pics.avs.io/99/36/${carrier}.png`}\r\n                                                                        alt={carrier} className=\"ticket__carrier\"/>\r\n                </div>\r\n            </div>\r\n\r\n            <div>{segments.map(({date, destination, duration, origin, stops}, idx) => {\r\n                return (\r\n                    <div className=\"segment\" key={idx}>\r\n                        <div className=\"segment__item segment__item_left\">\r\n                            <div className=\"segment__title\">{origin} - {destination}</div>\r\n                            <div\r\n                                className=\"segment__data\">{moment(date).format('HH:mm')} - {moment(date).add(duration, 'minutes').format('HH:mm')}</div>\r\n                        </div>\r\n                        <div className=\"segment__item segment__item_center\">\r\n                            <div className=\"segment__title\">В ПУТИ</div>\r\n                            <div className=\"segment__data\">{Math.floor(duration / 60)}ч {duration % 60}м</div>\r\n                        </div>\r\n                        <div className=\"segment__item segment__item_right\">\r\n                            <div\r\n                                className=\"segment__title\">{`${stops.length} ${['Пересадка', 'Пересадки', 'Пересадок'][(stops.length % 100 > 4 && stops.length % 100 < 20) ? 2 : [2, 0, 1, 1, 1, 2][(stops.length % 10 < 5) ? stops.length % 10 : 5]]}`}</div>\r\n                            <div className=\"segment__data\">{stops.join(', ')}</div>\r\n                        </div>\r\n                    </div>\r\n                )\r\n            })}</div>\r\n        </div>\r\n    ));\r\n    if (tickets.length > 0) {\r\n        return (\r\n            <div className=\"ticket-wrap\">\r\n                {tickets}\r\n            </div>\r\n        );\r\n    }\r\n    return (\r\n        <div>\r\n            <svg className=\"spinner__svg\" viewBox=\"0 0 50 50\">\r\n                <circle className=\"spinner__circle\" cx=\"25\" cy=\"25\" r=\"20\" fill=\"none\"/>\r\n            </svg>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default Ticket;","import React from 'react';\r\nimport './index.css';\r\n\r\nfunction Filter(props) {\r\n    const filter = props.filter.map((item, idx) => (\r\n        <div key={idx} className=\"checkbox-wrap\">\r\n            <div className=\"checkbox-wrap__item\">\r\n                <input id={`cb${idx}`} type=\"checkbox\" value={item.steps}\r\n                       checked={item.checked} onChange={props.onChange}/><label\r\n                htmlFor={`cb${idx}`}>{item.text}</label>\r\n            </div>\r\n\r\n        </div>\r\n    ));\r\n    return (\r\n        <div className=\"filter\">\r\n            <div className=\"filter__title\">Количество пересадок</div>\r\n            {filter}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Filter;","import React from 'react';\r\nimport './index.css';\r\n\r\nfunction Sorting(props) {\r\n    return (\r\n        <div className=\"sorting\">\r\n            <ul className=\"sorting__tabs\">\r\n                <li id=\"price\" className={`sorting__tab ${props.sorting == 'price' ? 'is-active' : ''}`}\r\n                    onClick={props.handleSorting}>\r\n                    Самый дешевый\r\n                </li>\r\n                <li id=\"speed\" className={`sorting__tab ${props.sorting == 'speed' ? 'is-active' : ''}`}\r\n                    onClick={props.handleSorting}>\r\n                    Самый быстрый\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Sorting;\r\n","import React from 'react';\nimport './index.css';\nimport Ticket from \"../Ticket\";\nimport Filter from \"../Filter\";\nimport Sorting from \"../Sorting\";\n\nlet searchId = '', tickets = [];\nconst abortController = new AbortController();\n\nclass App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            searchId: '',\n            tickets: [],\n            checkedCount: 3,\n            sorting: 'price',\n            filter: [{\n                steps: 'all',\n                text: 'Все',\n                checked: false\n            }, {\n                steps: 0,\n                text: 'Без пересадок',\n                checked: true\n            }, {\n                steps: 1,\n                text: '1 пересадка',\n                checked: true\n            }, {\n                steps: 2,\n                text: '2 пересадки',\n                checked: true\n            }, {\n                steps: 3,\n                text: '3 пересадки',\n                checked: false\n            }]\n        }\n        this.handleFilter = this.handleFilter.bind(this);\n        this.handleSorting = this.handleSorting.bind(this);\n    }\n\n    async fetchSearchId() {\n        const response = await fetch('https://front-test.beta.aviasales.ru/search', {\n            method: 'GET',\n            headers: {Accept: 'application/json'},\n            signal: abortController.signal\n        });\n        if (response.status !== 200) {\n            console.log(`An error has occurred: ${response.statusText}`);\n        } else {\n            const data = await response.json()\n            searchId = data.searchId;\n        }\n    }\n\n    async fetchTickets(searchId) {\n        const response = await fetch(`https://front-test.beta.aviasales.ru/tickets?searchId=${searchId}`, {\n            method: 'GET',\n            headers: {Accept: 'application/json'},\n            signal: abortController.signal\n        })\n        if (response.status === 502) {\n            await this.fetchTickets(searchId);\n        } else if (response.status !== 200) {\n            console.log(`An error has occurred: ${response.statusText}`);\n            await new Promise(resolve => setTimeout(resolve, 1000));\n            await this.fetchTickets(searchId);\n        } else {\n            const data = await response.json()\n            tickets = [...tickets, ...data.tickets];\n            console.log(tickets);\n            if (data.stop) {\n                abortController.abort();\n            } else {\n                await this.fetchTickets(searchId);\n            }\n        }\n    }\n\n    handleSorting(e) {\n        this.setState({\n            sorting: e.target.id === 'price' ? 'price' : 'speed'\n        });\n    }\n\n    handleFilter(e) {\n\n        this.setState(state => {\n            if (e.target.value === 'all') {\n                return {\n                    filter: state.filter.map(item => ({...item, checked: e.target.checked})),\n                    checkedCount: e.target.checked ? 4 : 0\n                }\n            }\n            if ((state.checkedCount + (e.target.checked ? 1 : -1)) === 4) {\n                return {\n                    filter: state.filter.map(item => ({...item, checked: true})),\n                    checkedCount: 4\n                }\n            }\n            return {\n                filter: state.filter.map(item => item.steps === 'all' ? {\n                    ...item,\n                    checked: false\n                } : item.steps == e.target.value ? {\n                    ...item,\n                    checked: e.target.checked\n                } : item),\n                checkedCount: (state.checkedCount + (e.target.checked ? 1 : -1))\n            }\n        });\n    }\n\n    componentDidMount() {\n        this.fetchSearchId()\n            .then(() => {\n                this.fetchTickets(searchId).then(() => {\n                    this.setState({\n                        searchId,\n                        tickets\n                    });\n                });\n            });\n    }\n\n    render() {\n        return (\n            <div className=\"App\">\n                <Filter filter={this.state.filter} onChange={this.handleFilter}/>\n                <div className=\"app-content\">\n                    <Sorting handleSorting={this.handleSorting} sorting={this.state.sorting}/>\n                    <Ticket searchId={this.state.searchId} tickets={this.state.tickets} filter={this.state.filter}\n                            sorting={this.state.sorting}/>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n    if (onPerfEntry && onPerfEntry instanceof Function) {\n        import('web-vitals').then(({getCLS, getFID, getFCP, getLCP, getTTFB}) => {\n            getCLS(onPerfEntry);\n            getFID(onPerfEntry);\n            getFCP(onPerfEntry);\n            getLCP(onPerfEntry);\n            getTTFB(onPerfEntry);\n        });\n    }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <App/>\n    </React.StrictMode>,\n    document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
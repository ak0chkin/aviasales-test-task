(this["webpackJsonpaviasales-test-task"]=this["webpackJsonpaviasales-test-task"]||[]).push([[0],{19:function(e,t,c){},21:function(e,t,c){},23:function(e,t,c){},24:function(e,t,c){},25:function(e,t,c){},26:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c(1),a=c.n(s),i=c(9),r=c.n(i),l=(c(19),c(2)),o=c(8),d=c(4),h=c.n(d),u=c(6),j=c(10),m=c(11),f=c(3),g=c(13),b=c(12),p=(c(21),c(7)),x=c.n(p);c(23);var k=function(e){var t=e.filter.filter((function(e){return e.checked})).map((function(e){return e.steps})),c=(t.includes("all")?e.tickets:e.tickets.filter((function(e){return e.segments.every((function(e){var c=e.stops;return t.includes(c.length)}))}))).sort((function(t,c){return"price"===e.sorting?t.price-c.price:t.segments.reduce((function(e,t){return e.duration+t.duration}))-c.segments.reduce((function(e,t){return e.duration+t.duration}))})).slice(0,5).map((function(e,t){var c=e.carrier,s=e.price,a=e.segments;return Object(n.jsxs)("div",{className:"ticket",children:[Object(n.jsxs)("div",{className:"ticket__header segment",children:[Object(n.jsxs)("div",{className:"segment__item segment__item_left ticket__price",children:[s.toFixed().replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")," \u0420"]}),Object(n.jsx)("div",{className:"segment__item segment__item_center"}),Object(n.jsx)("div",{className:"segment__item segment__item_right",children:Object(n.jsx)("img",{src:"//pics.avs.io/99/36/".concat(c,".png"),alt:c,className:"ticket__carrier"})})]}),Object(n.jsx)("div",{children:a.map((function(e,t){var c=e.date,s=e.destination,a=e.duration,i=e.origin,r=e.stops;return Object(n.jsxs)("div",{className:"segment",children:[Object(n.jsxs)("div",{className:"segment__item segment__item_left",children:[Object(n.jsxs)("div",{className:"segment__title",children:[i," - ",s]}),Object(n.jsxs)("div",{className:"segment__data",children:[x()(c).format("HH:mm")," - ",x()(c).add(a,"minutes").format("HH:mm")]})]}),Object(n.jsxs)("div",{className:"segment__item segment__item_center",children:[Object(n.jsx)("div",{className:"segment__title",children:"\u0412 \u041f\u0423\u0422\u0418"}),Object(n.jsxs)("div",{className:"segment__data",children:[Math.floor(a/60),"\u0447 ",a%60,"\u043c"]})]}),Object(n.jsxs)("div",{className:"segment__item segment__item_right",children:[Object(n.jsx)("div",{className:"segment__title",children:"".concat(r.length," ").concat(["\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"][r.length%100>4&&r.length%100<20?2:[2,0,1,1,1,2][r.length%10<5?r.length%10:5]])}),Object(n.jsx)("div",{className:"segment__data",children:r.join(", ")})]})]},t)}))})]},t)}));return c.length>0?Object(n.jsx)("div",{className:"ticket-wrap",children:c}):Object(n.jsx)("div",{children:Object(n.jsx)("svg",{className:"spinner__svg",viewBox:"0 0 50 50",children:Object(n.jsx)("circle",{className:"spinner__circle",cx:"25",cy:"25",r:"20",fill:"none"})})})};c(24);var v=function(e){var t=e.filter.map((function(t,c){return Object(n.jsx)("div",{className:"checkbox-wrap",children:Object(n.jsxs)("div",{className:"checkbox-wrap__item",children:[Object(n.jsx)("input",{id:"cb".concat(c),type:"checkbox",value:t.steps,checked:t.checked,onChange:e.onChange}),Object(n.jsx)("label",{htmlFor:"cb".concat(c),children:t.text})]})},c)}));return Object(n.jsxs)("div",{className:"filter",children:[Object(n.jsx)("div",{className:"filter__title",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),t]})};c(25);var _=function(e){return Object(n.jsx)("div",{className:"sorting",children:Object(n.jsxs)("ul",{className:"sorting__tabs",children:[Object(n.jsx)("li",{id:"price",className:"sorting__tab ".concat("price"===e.sorting?"is-active":""),onClick:e.handleSorting,children:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"}),Object(n.jsx)("li",{id:"speed",className:"sorting__tab ".concat("speed"===e.sorting?"is-active":""),onClick:e.handleSorting,children:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"})]})})},O="",N=[],C=new AbortController,S=function(e){Object(g.a)(c,e);var t=Object(b.a)(c);function c(e){var n;return Object(j.a)(this,c),(n=t.call(this,e)).state={searchId:"",tickets:[],checkedCount:3,sorting:"price",filter:[{steps:"all",text:"\u0412\u0441\u0435",checked:!1},{steps:0,text:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",checked:!0},{steps:1,text:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",checked:!0},{steps:2,text:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",checked:!0},{steps:3,text:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",checked:!1}]},n.handleFilter=n.handleFilter.bind(Object(f.a)(n)),n.handleSorting=n.handleSorting.bind(Object(f.a)(n)),n}return Object(m.a)(c,[{key:"fetchSearchId",value:function(){var e=Object(u.a)(h.a.mark((function e(){var t,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/search",{method:"GET",headers:{Accept:"application/json"},signal:C.signal});case 2:if(200===(t=e.sent).status){e.next=7;break}console.log("An error has occurred: ".concat(t.statusText)),e.next=11;break;case 7:return e.next=9,t.json();case 9:c=e.sent,O=c.searchId;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchTickets",value:function(){var e=Object(u.a)(h.a.mark((function e(t){var c,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(t),{method:"GET",headers:{Accept:"application/json"},signal:C.signal});case 2:if(502!==(c=e.sent).status){e.next=8;break}return e.next=6,this.fetchTickets(t);case 6:e.next=27;break;case 8:if(200===c.status){e.next=16;break}return console.log("An error has occurred: ".concat(c.statusText)),e.next=12,new Promise((function(e){return setTimeout(e,1e3)}));case 12:return e.next=14,this.fetchTickets(t);case 14:e.next=27;break;case 16:return e.next=18,c.json();case 18:if(n=e.sent,N=[].concat(Object(o.a)(N),Object(o.a)(n.tickets)),console.log(N),!n.stop){e.next=25;break}C.abort(),e.next=27;break;case 25:return e.next=27,this.fetchTickets(t);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSorting",value:function(e){this.setState({sorting:"price"===e.target.id?"price":"speed"})}},{key:"handleFilter",value:function(e){this.setState((function(t){return"all"===e.target.value?{filter:t.filter.map((function(t){return Object(l.a)(Object(l.a)({},t),{},{checked:e.target.checked})})),checkedCount:e.target.checked?4:0}:t.checkedCount+(e.target.checked?1:-1)===4?{filter:t.filter.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{checked:!0})})),checkedCount:4}:{filter:t.filter.map((function(t){return"all"===t.steps?Object(l.a)(Object(l.a)({},t),{},{checked:!1}):t.steps==e.target.value?Object(l.a)(Object(l.a)({},t),{},{checked:e.target.checked}):t})),checkedCount:t.checkedCount+(e.target.checked?1:-1)}}))}},{key:"componentDidMount",value:function(){var e=this;this.fetchSearchId().then((function(){e.fetchTickets(O).then((function(){e.setState({searchId:O,tickets:N})}))}))}},{key:"render",value:function(){return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(v,{filter:this.state.filter,onChange:this.handleFilter}),Object(n.jsxs)("div",{className:"app-content",children:[Object(n.jsx)(_,{handleSorting:this.handleSorting,sorting:this.state.sorting}),Object(n.jsx)(k,{searchId:this.state.searchId,tickets:this.state.tickets,filter:this.state.filter,sorting:this.state.sorting})]})]})}}]),c}(a.a.Component),w=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,27)).then((function(t){var c=t.getCLS,n=t.getFID,s=t.getFCP,a=t.getLCP,i=t.getTTFB;c(e),n(e),s(e),a(e),i(e)}))};r.a.render(Object(n.jsx)(a.a.StrictMode,{children:Object(n.jsx)(S,{})}),document.getElementById("root")),w()}},[[26,1,2]]]);
//# sourceMappingURL=main.7c7e7daf.chunk.js.map
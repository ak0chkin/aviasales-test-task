(this["webpackJsonpaviasales-test-task"]=this["webpackJsonpaviasales-test-task"]||[]).push([[0],{19:function(e,t,n){},21:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(1),a=n.n(s),r=n(13),i=n.n(r),o=(n(19),n(2)),l=n(12),h=n(8),d=n.n(h),u=n(10),j=n(3),m=n(4),p=n(7),b=n(6),f=n(5),g=(n(21),n(11)),k=n.n(g),x=(n(23),function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(j.a)(this,n),t.call(this,e)}return Object(m.a)(n,[{key:"render",value:function(){var e=this,t=this.props.filter.filter((function(e){return e.checked})).map((function(e){return e.steps})),n=(t.includes("all")?this.props.tickets:this.props.tickets.filter((function(e){return e.segments.every((function(e){var n=e.stops;return t.includes(n.length)}))}))).sort((function(t,n){return"price"===e.props.sorting?t.price-n.price:t.segments.reduce((function(e,t){return e.duration+t.duration}))-n.segments.reduce((function(e,t){return e.duration+t.duration}))})).slice(0,5).map((function(e,t){var n=e.carrier,s=e.price,a=e.segments;return Object(c.jsxs)("div",{className:"ticket",children:[Object(c.jsxs)("div",{className:"ticket__header segment",children:[Object(c.jsxs)("div",{className:"segment__item segment__item_left ticket__price",children:[s.toFixed().replace(/(\d)(?=(\d{3})+([^\d]|$))/g,"$1 ")," \u0420"]}),Object(c.jsx)("div",{className:"segment__item segment__item_center"}),Object(c.jsx)("div",{className:"segment__item segment__item_right",children:Object(c.jsx)("img",{src:"//pics.avs.io/99/36/".concat(n,".png"),alt:n,className:"ticket__carrier"})})]}),Object(c.jsx)("div",{children:a.map((function(e,t){var n=e.date,s=e.destination,a=e.duration,r=e.origin,i=e.stops;return Object(c.jsxs)("div",{className:"segment",children:[Object(c.jsxs)("div",{className:"segment__item segment__item_left",children:[Object(c.jsxs)("div",{className:"segment__title",children:[r," - ",s]}),Object(c.jsxs)("div",{className:"segment__data",children:[k()(n).format("HH:mm")," - ",k()(n).add(a,"minutes").format("HH:mm")]})]}),Object(c.jsxs)("div",{className:"segment__item segment__item_center",children:[Object(c.jsx)("div",{className:"segment__title",children:"\u0412 \u041f\u0423\u0422\u0418"}),Object(c.jsxs)("div",{className:"segment__data",children:[Math.floor(a/60),"\u0447 ",a%60,"\u043c"]})]}),Object(c.jsxs)("div",{className:"segment__item segment__item_right",children:[Object(c.jsx)("div",{className:"segment__title",children:"".concat(i.length," ").concat(["\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430","\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438","\u041f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"][i.length%100>4&&i.length%100<20?2:[2,0,1,1,1,2][i.length%10<5?i.length%10:5]])}),Object(c.jsx)("div",{className:"segment__data",children:i.join(", ")})]})]},t)}))})]},t)}));return Object(c.jsx)("div",{className:"ticket-wrap",children:n})}}]),n}(a.a.Component)),O=(n(24),function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(j.a)(this,n),t.call(this,e)}return Object(m.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props.filter.map((function(t,n){return Object(c.jsx)("div",{className:"checkbox-wrap",children:Object(c.jsxs)("div",{className:"checkbox-wrap__item",children:[Object(c.jsx)("input",{id:"cb".concat(n),type:"checkbox",value:t.steps,checked:t.checked,onChange:e.props.onChange}),Object(c.jsx)("label",{htmlFor:"cb".concat(n),children:t.text})]})},n)}));return Object(c.jsxs)("div",{className:"filter",children:[Object(c.jsx)("div",{className:"filter__title",children:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a"}),t]})}}]),n}(a.a.Component)),v=(n(25),function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){return Object(j.a)(this,n),t.call(this,e)}return Object(m.a)(n,[{key:"render",value:function(){return Object(c.jsx)("div",{className:"sorting",children:Object(c.jsxs)("ul",{className:"sorting__tabs",children:[Object(c.jsx)("li",{id:"price",className:"sorting__tab ".concat("price"==this.props.sorting?"is-active":""),onClick:this.props.handleSorting,children:"\u0421\u0430\u043c\u044b\u0439 \u0434\u0435\u0448\u0435\u0432\u044b\u0439"}),Object(c.jsx)("li",{id:"speed",className:"sorting__tab ".concat("speed"==this.props.sorting?"is-active":""),onClick:this.props.handleSorting,children:"\u0421\u0430\u043c\u044b\u0439 \u0431\u044b\u0441\u0442\u0440\u044b\u0439"})]})})}}]),n}(a.a.Component)),_="",N=[],C=new AbortController,y=function(e){Object(b.a)(n,e);var t=Object(f.a)(n);function n(e){var c;return Object(j.a)(this,n),(c=t.call(this,e)).state={searchId:"",tickets:[],checkedCount:3,sorting:"price",filter:[{steps:"all",text:"\u0412\u0441\u0435",checked:!1},{steps:0,text:"\u0411\u0435\u0437 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043e\u043a",checked:!0},{steps:1,text:"1 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0430",checked:!0},{steps:2,text:"2 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",checked:!0},{steps:3,text:"3 \u043f\u0435\u0440\u0435\u0441\u0430\u0434\u043a\u0438",checked:!1}]},c.handleFilter=c.handleFilter.bind(Object(p.a)(c)),c.handleSorting=c.handleSorting.bind(Object(p.a)(c)),c}return Object(m.a)(n,[{key:"fetchSearchId",value:function(){var e=Object(u.a)(d.a.mark((function e(){var t,n;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/search",{method:"GET",headers:{Accept:"application/json"},signal:C.signal});case 2:if(200===(t=e.sent).status){e.next=7;break}console.log("An error has occurred: ".concat(t.statusText)),e.next=11;break;case 7:return e.next=9,t.json();case 9:n=e.sent,_=n.searchId;case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchTickets",value:function(){var e=Object(u.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://front-test.beta.aviasales.ru/tickets?searchId=".concat(t),{method:"GET",headers:{Accept:"application/json"},signal:C.signal});case 2:if(502!==(n=e.sent).status){e.next=8;break}return e.next=6,this.fetchTickets(t);case 6:e.next=27;break;case 8:if(200===n.status){e.next=16;break}return console.log("An error has occurred: ".concat(n.statusText)),e.next=12,new Promise((function(e){return setTimeout(e,1e3)}));case 12:return e.next=14,this.fetchTickets(t);case 14:e.next=27;break;case 16:return e.next=18,n.json();case 18:if(c=e.sent,N=[].concat(Object(l.a)(N),Object(l.a)(c.tickets)),console.log(N),!c.stop){e.next=25;break}C.abort(),e.next=27;break;case 25:return e.next=27,this.fetchTickets(t);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleSorting",value:function(e){this.setState({sorting:"price"===e.target.id?"price":"speed"})}},{key:"handleFilter",value:function(e){this.setState((function(t){return"all"===e.target.value?{filter:t.filter.map((function(t){return Object(o.a)(Object(o.a)({},t),{},{checked:e.target.checked})})),checkedCount:e.target.checked?4:0}:t.checkedCount+(e.target.checked?1:-1)===4?{filter:t.filter.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{checked:!0})})),checkedCount:4}:{filter:t.filter.map((function(t){return"all"===t.steps?Object(o.a)(Object(o.a)({},t),{},{checked:!1}):t.steps==e.target.value?Object(o.a)(Object(o.a)({},t),{},{checked:e.target.checked}):t})),checkedCount:t.checkedCount+(e.target.checked?1:-1)}}))}},{key:"componentDidMount",value:function(){var e=this;this.fetchSearchId().then((function(){e.fetchTickets(_).then((function(){e.setState({searchId:_,tickets:N})}))}))}},{key:"render",value:function(){return Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(O,{filter:this.state.filter,onChange:this.handleFilter}),Object(c.jsxs)("div",{className:"app-content",children:[Object(c.jsx)(v,{handleSorting:this.handleSorting,sorting:this.state.sorting}),Object(c.jsx)(x,{searchId:this.state.searchId,tickets:this.state.tickets,filter:this.state.filter,sorting:this.state.sorting})]})]})}}]),n}(a.a.Component),S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,c=t.getFID,s=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),c(e),s(e),a(e),r(e)}))};i.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(y,{})}),document.getElementById("root")),S()}},[[26,1,2]]]);
//# sourceMappingURL=main.9c3d1765.chunk.js.map